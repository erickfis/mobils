
## Análise por tipo de despesa: Alimentação

O primeiro item da lista dos tipos de despesas mais oscilantes é alimentação. Vejamos como este tipo de despesa se comporta ao longo dos anos:


```{r alimentacao, cache=TRUE}
#devidos subsets

totais.alim <- totais[totais$tipo=="alimentação",]

medias.alim <- totais.alim %>% group_by(ano) %>%
        summarise(media = mean(total.raw))

medias.alim$media <- round(medias.alim$media, 2)

plt.alim <- ggplot(totais.alim, aes(x=mes, y=total.raw, group=ano, colour=ano,
                text = paste(ano, "-", mes, 
                             "<br>", total)))
                                 
plt.alim <- plt.alim +  geom_line() + 
                geom_point(size=1, alpha=0.5) +
                geom_hline(data = medias.alim, 
                           aes(yintercept = media, colour = ano,
                                 text=paste(real(media))),
                           linetype=2) +
                # geom_label(data = medias.alim, vjust = -0.2, hjust = 1,
                #           aes(12, y = media,label=media)) +
                labs(title="Gastos com alimentação", y="Total (R$)", x="Mês") +
                theme(plot.title = element_text(hjust = 0.5)) 

ggplotly(plt.alim, tooltip = "text")

```

Observa-se:

- tendência a aumento de gastos em maio de 2015 e 2016
- até 2016, tendência a aumento de gastos em julho
- aumento da média em 2017
- as compras maiores são feitas a cada 2 meses, 


Vamos analisar na tabela de dados os principais registros:

```{r tabela-alim}
sub <- which(dadosFil$ano==2015 & dadosFil$mes %in% c("Jul") & 
                     dadosFil$tipo=="alimentação" & dadosFil$valor.raw > 50) 

dados.sel <- dadosFil[sub,]
rank <- order(dados.sel$valor.raw, decreasing = TRUE)

kable(dados.sel[rank,c(1,6,8)], caption = "Gastos em julho de 2015")

###
sub <- which(dadosFil$ano==2016 & dadosFil$mes %in% c("Jul") & 
                     dadosFil$tipo=="alimentação" & dadosFil$valor.raw > 50) 

dados.sel <- dadosFil[sub,]
rank <- order(dados.sel$valor.raw, decreasing = TRUE)

kable(dados.sel[rank,c(1,6,8)], caption = "Gastos em julho de 2016")

###
sub <- which(dadosFil$ano==2017 & dadosFil$mes %in% c("Jun") & 
                     dadosFil$tipo=="alimentação" & dadosFil$valor.raw > 50) 

dados.sel <- dadosFil[sub,]
rank <- order(dados.sel$valor.raw, decreasing = TRUE)

kable(dados.sel[rank,c(1,6,8)], caption = "Gastos em junho de 2017")
```


Analizando os dados mais de perto, verifica-se que:

- até 2016, há tendência para gastos extras com a páscoa.
- em julho de 2016 foram feitas 2 compras mensais, para aproveitar uma promoção.
- o aumento da média em 2016 ocorre porque, além dos fatores acima, em março 2015 os gastos não foram registrados.
- o aumento da média em 2017 ocorre porque a família aumentou.

Por hora, não fica evidenciada a necessidade de mudanças em despesas com alimentação.


