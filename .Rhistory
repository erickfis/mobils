theme(legend.position="bottom") +
# theme(legend.title=element_blank()) +
# theme(axis.text.y = element_blank()) +
# theme(axis.ticks.y = element_blank()) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5))
# + coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = "dodge") +
facet_wrap(tipo~,ncol=1) +
(maiores.plt +
geom_bar(stat="identity", position = "dodge") +
facet_wrap(.~tipo,ncol=1) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
# theme(legend.title=element_blank()) +
# theme(axis.text.y = element_blank()) +
# theme(axis.ticks.y = element_blank()) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5))
# + coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = "dodge") +
facet_wrap(~tipo,ncol=1) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
# theme(legend.title=element_blank()) +
# theme(axis.text.y = element_blank()) +
# theme(axis.ticks.y = element_blank()) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5))
# + coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = "dodge") +
facet_wrap(tipo~,ncol=1) +
View(maiores)
maiores <- totais %>% group_by(tipo, ano) %>%
summarise(media.anual = round(mean(total),2),
sd.anual=round(sd(total), 2)) %>%
mutate(media.geral = round(mean(media.anual),2),
sd.geral=round(sd(media.anual), 2)) %>%
arrange(desc(media.geral), ano, tipo)
maiores$tipo <- factor(maiores$tipo,
levels = maiores$tipo[order(maiores$media.geral,
decreasing = TRUE)])
maiores$tipo <- factor(maiores$tipo,
levels = maiores$tipo[order(unique(maiores$media.geral),
decreasing = TRUE)])
maiores <- totais %>% group_by(tipo, ano) %>%
summarise(media.anual = round(mean(total),2),
sd.anual=round(sd(total), 2)) %>%
mutate(media.geral = round(mean(media.anual),2),
sd.geral=round(sd(media.anual), 2)) %>%
arrange(desc(media.geral), ano, tipo) %>%
mutate(rank = 1:length(media.geral))
maiores <- totais %>% group_by(tipo, ano) %>%
summarise(media.anual = round(mean(total),2),
sd.anual=round(sd(total), 2)) %>%
mutate(media.geral = round(mean(media.anual),2),
sd.geral=round(sd(media.anual), 2)) %>%
arrange(desc(media.geral), ano, tipo) %>%
group_by(tipo) %>%
mutate(rank = 1:length(media.geral))
maiores <- totais %>% group_by(tipo, ano) %>%
summarise(media.anual = round(mean(total),2),
sd.anual=round(sd(total), 2)) %>%
mutate(media.geral = round(mean(media.anual),2),
sd.geral=round(sd(media.anual), 2)) %>%
arrange(desc(media.geral), ano, tipo) %>%
ungroup() %>%
mutate(rank = 1:length(media.geral))
maiores <- totais %>% group_by(tipo, ano) %>%
summarise(media.anual = round(mean(total),2),
sd.anual=round(sd(total), 2)) %>%
mutate(media.geral = round(mean(media.anual),2),
sd.geral=round(sd(media.anual), 2)) %>%
arrange(desc(media.geral), ano, tipo) %>%
ungroup() %>% group_by(tipo) %>%
mutate(rank = 1:length(media.geral))
maiores <- totais %>% group_by(tipo, ano) %>%
summarise(media.anual = round(mean(total),2),
sd.anual=round(sd(total), 2)) %>%
mutate(media.geral = round(mean(media.anual),2),
sd.geral=round(sd(media.anual), 2)) %>%
arrange(desc(media.geral), ano, tipo) %>%
ungroup() %>%
mutate(rank = 1:length(media.geral))
maiores$tipo <- factor(maiores$tipo,
levels = maiores$tipo[order(maiores$rank,
decreasing = TRUE)])
maiores <- totais %>% group_by(tipo, ano) %>%
summarise(media.anual = round(mean(total),2),
sd.anual=round(sd(total), 2)) %>%
mutate(media.geral = round(mean(media.anual),2),
sd.geral=round(sd(media.anual), 2)) %>%
arrange(desc(media.geral), ano, tipo)
maiores.plt <- ggplot(maiores, aes(tipo, media.anual,
fill=ano))
(maiores.plt +
geom_bar(stat="identity", position = position=position_dodge()) +
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
# facet_wrap(~tipo,ncol=1) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
# theme(legend.title=element_blank()) +
# theme(axis.text.y = element_blank()) +
# theme(axis.ticks.y = element_blank()) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5))
# + coord_flip()
)
maiores <- subset(maiores, media.geral > 200)
colourCount = length(unique(maiores$tipo))
getPalette = colorRampPalette(brewer.pal(colourCount, "Set1"))
maiores.plt <- ggplot(maiores, aes(tipo, media.anual,
fill=ano))
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
# facet_wrap(~tipo,ncol=1) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
# theme(legend.title=element_blank()) +
# theme(axis.text.y = element_blank()) +
# theme(axis.ticks.y = element_blank()) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5))
# + coord_flip()
)
maiores.plt <- ggplot(maiores, aes(tipo, media.anual,
fill=ano))
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
# facet_wrap(~tipo,ncol=1) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
# facet_wrap(~tipo,ncol=1) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
geom_text(aes(label=tipo),
vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
facet_wrap(~tipo,ncol=1) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
geom_text(aes(label=tipo),
vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5))
# coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
facet_wrap(~tipo,ncol=1) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
geom_text(aes(label=tipo),
vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
facet_grid(.~tipo) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
geom_text(aes(label=tipo),
vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
facet_grid(tipo~.) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
# facet_grid(tipo~.) +
facet_wrap(tipo~.) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
# facet_grid(tipo~.) +
facet_wrap(tipo~) +
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
# facet_grid(tipo~.) +
facet_wrap(tipo) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
# facet_grid(tipo~.) +
facet_wrap(~tipo) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
# facet_grid(tipo~.) +
facet_wrap(tipo~) +
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
facet_grid(tipo~.) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
facet_grid(tipo~.,scales = "free") +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
facet_grid(tipo~.,scales = "free", space = "free") +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
facet_grid(tipo~ano,scales = "free", space = "free") +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
facet_grid(tipo~,scales = "free", space = "free") +
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
facet_grid(tipo~., scales = "free", space = "free") +
theme(strip.text.y = element_text(angle = 0)) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
facet_grid(tipo~., scales = "free", space = "free") +
theme(strip.text.y = element_text(angle = 90)) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
facet_grid(tipo~., scales = "free", space = "free") +
theme(strip.text.x = element_text(angle = 90)) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
(maiores.plt +
geom_bar(stat="identity", position = position_dodge()) +
facet_grid(tipo~., scales = "free", space = "free") +
theme(strip.text.y = element_text(angle = 0)) +
labs(title=" Média das maiores despesas, por tipo",
y="", x="") +
# geom_text(aes(label=tipo),
#         vjust=.5, hjust=1.1, colour="white") +
scale_y_continuous(labels = real) +
scale_colour_manual(values = getPalette(colourCount))+
theme(legend.position="bottom") +
theme(legend.title=element_blank()) +
theme(axis.text.y = element_blank()) +
theme(axis.ticks.y = element_blank()) +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
theme(plot.title = element_text(hjust = 0.5)) +
coord_flip()
)
unlink('~/Documents/dataS-anotacoes/mobils/index_cache', recursive = TRUE)
maiores <- totais %>% group_by(tipo, ano) %>%
summarise(media.anual = round(mean(total),2),
sd.anual=round(sd(total), 2)) %>%
mutate(media.geral = round(mean(media.anual),2),
sd.geral=round(sd(media.anual), 2)) %>%
arrange(desc(media.geral), ano, tipo)
maiores <- subset(maiores, media.geral > 200)
maiores.df.plot <-  maiores %>% group_by(tipo) %>%
summarise(media = round(mean(media.anual),2)) %>%
arrange(desc(media)) %>%
mutate(rank = 1:length(media))
maiores.df.plot$tipo <- factor(maiores.df.plot$tipo,
levels = maiores.df.plot$tipo[order(maiores.df.plot$rank,
decreasing = TRUE)])
maiores$tipo <- factor(maiores$tipo, levels = maiores.df.plot$tipo)
maiores$ano <- factor(maiores$ano,
levels = maiores$ano[order(maiores$ano)])
maiores$ano <- factor(maiores$ano,
levels = c(2015, 2016,2017))
maiores$ano
unlink('~/Documents/dataS-anotacoes/mobils/index_cache', recursive = TRUE)
maiores$rank <- rank(maiores$media.geral)
View(maiores)
?rank()
maiores$r2 <- ave(count, media.geral, FUN = function(x) rank(-x, ties.method = "first"))
View(maiores)
maiores$r2 <- ave(count, maiores$media.geral, FUN = function(x) rank(-x, ties.method = "first"))
maiores$r2 <- ave(maiores$media.geral, FUN = function(x) rank(-x, ties.method = "first"))
maiores$r2 <- ave(tipo, maiores$media.geral, FUN = function(x) rank(-x, ties.method = "first"))
maiores$r2 <- ave(maiores$tipo, maiores$media.geral, FUN = function(x) rank(-x, ties.method = "first"))
maiores$r2 <- ave(maiores$media.geral, maiores$tipo, FUN = function(x) rank(-x, ties.method = "first"))
maiores$r2 <- ave(maiores$media.geral, FUN = function(x) rank(-x, ties.method = "max"))
maiores$r2 <- ave(maiores$media.geral, FUN = function(x) rank(-x, ties.method = "min"))
library(scales)
library(stringr)
library(data.table)
library(readxl)
# library(chron)
library(dplyr)
library(lubridate)
library(ggplot2)
library(rmarkdown)
library(RColorBrewer)
library(gridExtra)
library(grid)
library(plotly)
library(knitr)
opts_chunk$set(echo = FALSE, message = FALSE, include = TRUE,
warning = FALSE, autodep = TRUE, options(scipen=999))
View(maiores)
