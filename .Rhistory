tipo = tolower(as.character(tipo)),
mes = month(data, label=TRUE),
ano = year(data)
) %>%
## filtrando as informações que interessam, ou seja, somente da conta itau
## e datas acima de 01-01-15, vamos considerar que eu não usava bem o app antes disso
filter(conta=="itau" & data >= as.Date("2015-01-01")) %>%
## remove as colunas indesejadas
select(data, ano, mes, tipo, descrição, valor)
tail(dadosM)
dadosM <- dadosT %>%    rename(tipo = tipo.de.despesa) %>%
mutate(data = parse_date_time(data, "dmY"),
descrição = tolower(as.character(descrição)),
tipo = tolower(as.character(tipo)),
mes = month(data, label=TRUE),
ano = year(data)
) %>%
# filtrando as informações que interessam, ou seja, somente da conta itau
# e datas acima de 01-01-15, vamos considerar que eu não usava bem o app antes disso
# e abaixo de 25-03-2017, quando o arquivo foi gerado (pq o db tem dados de
# "previsão de gastos" até o fim do ano
filter(conta=="itau" &  data >= as.Date("2015-01-01") &
data <= as.Date("2017-03-25")) %>%
## remove as colunas indesejadas
select(data, ano, mes, tipo, descrição, valor)
tail(dadosM)
write.csv(dadosM, "dadosM-2015a2017-03-25.csv")
dadosM
dadosM <- tbl_df(dadosM)
str(dadosM)
dadosM <- dadosT %>%    rename(tipo = tipo.de.despesa) %>%
mutate(data = parse_date_time(data, "dmY"),
descrição = tolower(as.character(descrição)),
tipo = tolower(as.character(tipo)),
mes = month(data, label=TRUE),
ano = factor(year(data))
) %>%
# filtrando as informações que interessam, ou seja, somente da conta itau
# e datas acima de 01-01-15, vamos considerar que eu não usava bem o app antes disso
# e abaixo de 25-03-2017, quando o arquivo foi gerado (pq o db tem dados de
# "previsão de gastos" até o fim do ano
filter(conta=="itau" &  data >= as.Date("2015-01-01") &
data <= as.Date("2017-03-25")) %>%
## remove as colunas indesejadas
select(data, ano, mes, tipo, descrição, valor)
str(dadosM)
dadosM$ano
str(dadosM)
dadosM <- dadosT %>%    rename(tipo = tipo.de.despesa) %>%
mutate(data = parse_date_time(data, "dmY"),
descrição = tolower(as.character(descrição)),
tipo = factor(tolower(as.character(tipo))),
mes = month(data, label=TRUE),
ano = factor(year(data))
) %>%
# filtrando as informações que interessam, ou seja, somente da conta itau
# e datas acima de 01-01-15, vamos considerar que eu não usava bem o app antes disso
# e abaixo de 25-03-2017, quando o arquivo foi gerado (pq o db tem dados de
# "previsão de gastos" até o fim do ano
filter(conta=="itau" &  data >= as.Date("2015-01-01") &
data <= as.Date("2017-03-25")) %>%
## remove as colunas indesejadas
select(data, ano, mes, tipo, descrição, valor)
dadosM <- dadosT %>%    rename(tipo = tipo.de.despesa) %>%
mutate(data = parse_date_time(data, "dmY"),
descrição = tolower(as.character(descrição)),
tipo = factor(tolower(as.character(tipo))),
mes = month(data, label=TRUE),
ano = factor(year(data))
) %>%
# filtrando as informações que interessam, ou seja, somente da conta itau
# e datas acima de 01-01-15, vamos considerar que eu não usava bem o app antes disso
# e abaixo de 25-03-2017, quando o arquivo foi gerado (pq o db tem dados de
# "previsão de gastos" até o fim do ano
filter(conta=="itau" &  data >= as.Date("2015-01-01") &
data <= as.Date("2017-03-25")) %>%
## remove as colunas indesejadas
select(data, ano, mes, tipo, descrição, valor)
# gravando o db para o disco
write.csv(dadosM, "dadosM-2015a2017-03-25.csv")
str(dadosM)
unique(dadosM$tipo)
dadosM["tipo"=="fatura c.crédito",]
dadosM["tipo"=="beleza",]
dadosM[dadosM$tipo=="beleza",]
dadosM[dadosM$tipo=="fatura c.crédito",]
unique(dadosM$tipo)
dadosM <- tbl_df(dadosM)
dadosM <- group_by(dadosM, tipo, ano, mes)
totais <- summarise(dadosM, total=sum(valor))
totais
require(ggplot2)
plt <- ggplot(totais, aes(x=mes, y=total, color=tipo))
(plt + geom_bar(stat="identity") + facet_grid(ano ~.) +
labs(title="Total Emissions in Baltimore by year", y="Emissions in tons") +
theme(plot.title = element_text(hjust = 0.5)) +
guides(fill=FALSE)
)
(plt + #geom_bar(stat="identity") +
geom_line()
facet_grid(ano ~.) +
labs(title="Total Emissions in Baltimore by year", y="Emissions in tons") +
theme(plot.title = element_text(hjust = 0.5)) +
guides(fill=FALSE)
)
(plt +  geom_line() +
facet_grid(ano ~.) +
labs(title="Total Emissions in Baltimore by year", y="Emissions in tons") +
theme(plot.title = element_text(hjust = 0.5)) +
guides(fill=FALSE)
)
(plt +  geom_line(identity) +
facet_grid(ano ~.) +
labs(title="Total Emissions in Baltimore by year", y="Emissions in tons") +
theme(plot.title = element_text(hjust = 0.5)) +
guides(fill=FALSE)
)
(plt +  geom_smooth() +
facet_grid(ano ~.) +
labs(title="Total Emissions in Baltimore by year", y="Emissions in tons") +
theme(plot.title = element_text(hjust = 0.5)) +
guides(fill=FALSE)
)
totais
(plt +  geom_line() +
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5)) +
guides(fill=FALSE)
)
(plt +  geom_point() +
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5)) +
guides(fill=FALSE)
)
(plt +  geom_point(identity) +
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5)) +
guides(fill=FALSE)
)
colourCount = length(unique(totais$tipo))
colourCount
require(RColorBrewer)
plt <- ggplot(totais, aes(x=mes, y=total, group = tipo, color=tipo))
(plt +  geom_point() +
scale_fill_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5)) +
guides(fill=FALSE)
)
plt <- qplot(x=totais$mes, y=totais$total, color=tipo, facets = ano~.)
?qplot
plt <- qplot(x=totais$mes, y=totais$total, data=totais, color=tipo, facets = ano~.)
plt
colourCount = length(unique(totais$tipo))
getPalette = colorRampPalette(brewer.pal(9, "Set1"))
plt <- ggplot(totais, aes(x=mes, y=total, fill=tipo))
(plt +  geom_bar(stat="identity") +
scale_fill_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5)) +
guides(fill=FALSE)
)
(plt +  geom_line(stat="identity") +
scale_fill_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5)) +
guides(fill=FALSE)
)
(plt +  geom_bar(stat="identity") +
scale_fill_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5)) +
# guides(fill=FALSE)
)
(plt +  geom_bar(stat="identity") +
scale_fill_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
plt <- ggplot(dadosM, aes(x=mes, y=valor, fill=tipo))
(plt +  geom_bar(stat="identity") +
scale_fill_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
View(totais)
plt <- ggplot(totais, aes(x=mes, y=valor, group=tipo, colour=tipo))
(plt +  geom_line() +
scale_fill_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
plt <- ggplot(totais, aes(x=mes, y=total, group=tipo, colour=tipo))
(plt +  geom_line() +
scale_fill_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
(plt +  geom_line() + geom_point()
scale_fill_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
(plt +  geom_line() + geom_point() +
scale_fill_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
colourCount = length(unique(totais$tipo))
getPalette = colorRampPalette(brewer.pal(9, "Set1"))
(plt +  geom_line() + geom_point() +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
dev.copy(png, file="plot1.png")
dev.off()
sub1 <- with(dadosM, ano==2017 & tipo=="alimentação")
with(dadosM, ano==2017 & tipo=="alimentação")
sub1 <- with(dadosM, ano==2017 & tipo=="alimentação")
sub2 <- with(dadosM, ano==2015 & mes="Mar" & tipo=="pagamentos")
sub2 <- with(dadosM, ano==2015 & mes=="Mar" & tipo=="pagamentos")
dadosM[which(sub1),]
dadosM[which(sub2),]
plt <- ggplot(totais, aes(x=mes, y=total, group=tipo, colour=tipo))
(plt +  geom_line() + geom_point() + ylim(0,2000) +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
plt <- ggplot(totais, aes(x=mes, y=total, group=tipo, colour=tipo))
(plt +  geom_line() + geom_point() + ylim(0,1750) +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
dev.copy(png, file="plotFinal.png")
dev.off()
dadosM[which(sub1),]
arrange(dadosM[which(sub1),], valor)
sub1 <- with(dadosM, ano==2017 & tipo=="alimentação" & mes %in% c("Jan", "Mar"))
arrange(dadosM[which(sub1),], valor)
?arrange(
?arrange
arrange(dadosM[which(sub1),], desc(valor))
dadosM[which(sub2),]
dadosFil <- dadosM
fonte <- dadosFil$descrição
filtro <- !which(grepl("[Pp]revisão", fonte) | grepl("[Vv]isa", fonte))
dadosFil <- dadosFil[filtro,]
fonte <- c("previsao de gastos", "visa", "gastos", "gastos com visa")
filtro <- !which(grepl("[Pp]revisão", fonte) | grepl("[Vv]isa", fonte))
fonte[filtro]
filtro <- which(!grepl("[Pp]revisão", fonte) | !grepl("[Vv]isa", fonte))
fonte[filtro]
filtro <- which(grepl("[Pp]revisão", fonte) | grepl("[Vv]isa", fonte))
fonte[filtro]
filtro <- !which(!grepl("[Pp]revisão", fonte) | !grepl("[Vv]isa", fonte))
filtro <- which(!grepl("[Pp]revisão", fonte) | !grepl("[Vv]isa", fonte))
filtro <- !which(!grep("[Pp]revisão", fonte) | !grep("[Vv]isa", fonte))
filtro <- !which(!grepl("[Pp]revisão", fonte) | !grepl("[Vv]isa", fonte))
grepl("[Pp]revisão", fonte) | grepl("[Vv]isa", fonte)
!(grepl("[Pp]revisão", fonte) | grepl("[Vv]isa", fonte))
which(!(grepl("[Pp]revisão", fonte) | grepl("[Vv]isa", fonte)))
filtro <- which(!(grepl("[Pp]revisão", fonte) | grepl("[Vv]isa", fonte)))
fonte[filtro]
fonte <- dadosFil$descrição
filtro <- which(!(grepl("[Pp]revisão", fonte) | grepl("[Vv]isa", fonte)))
fonte <- dadosFil$descrição
dadosFil <- dadosM
fonte <- dadosFil$descrição
filtro <- which(!(grepl("[Pp]revisão", fonte) | grepl("[Vv]isa", fonte)))
dadosFil <- dadosFil[filtro,]
dadosFil <- group_by(dadosFil, tipo, ano, mes)
totais <- summarise(dadosFil, total=sum(valor))
colourCount = length(unique(totais$tipo))
getPalette = colorRampPalette(brewer.pal(9, "Set1"))
plt <- ggplot(totais, aes(x=mes, y=total, group=tipo, colour=tipo))
(plt +  geom_line() + geom_point() +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
dev.copy(png, file="plot2.png")
dev.off()
totais <- totais[which(totais$ano %in% c(2015,2016)),]
View(totais)
plt <- ggplot(totais, aes(x=mes, y=total, group=tipo, colour=tipo))
(plt +  geom_line() + geom_point() +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
dev.copy(png, file="plot3.png")
dev.off()
(plt +  geom_line() + geom_point() + geom_abline(mean) + geom_abline(median) +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
plt <- ggplot(totais, aes(x=mes, y=total, group=tipo, colour=tipo))
(plt +  geom_line() + geom_point() + geom_abline(mean) + geom_abline(median) +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
dev.copy(png, file="plot3.png")
dev.off()
write.csv(totais, "totais-2015a2016-12-31.csv")
write.csv(dadosM, "dadosM.csv")
svd1 <- svd(scale(totais))
plt <- ggplot(totais, aes(x=mes, y=total, group=tipo, colour=tipo))
(plt +  geom_line() + geom_point() + geom_abline(mean) + geom_abline(median) +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(tipo ~ ano) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
(plt +  geom_line() + geom_point() + geom_abline(mean) + geom_abline(median) +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(tipo ~ ano) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
plt <- ggplot(totais, aes(x=mes, y=total, group=tipo, colour=tipo))
(plt +  geom_line() + geom_point() +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
plt <- ggplot(totais, aes(x=mes, y=total, group=tipo, colour=tipo))
(plt +  geom_line() + geom_point() +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(tipo ~ ano) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
plt <- ggplot(totais, aes(x=mes, y=total, colour=tipo))
(plt +  geom_line() + geom_point() +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(tipo ~ ano) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
plt <- ggplot(totais, aes(x=mes, y=total))
(plt +  geom_line() + geom_point() +
facet_grid(tipo ~ ano) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
plt <- ggplot(totais, aes(x=mes, y=total, group=tipo, colour=tipo))
(plt +  geom_line() + geom_point() +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
plt.alim <- ggplot(totais[tipo=="alimentação",], aes(x=mes, y=total, colour=tipo))
plt.alim <- ggplot(totais[tipo=="alimentação",], aes(x=mes, y=total))
View(totais)
plt.alim <- ggplot(totais["tipo"=="alimentação",], aes(x=mes, y=total))
geomas <- (geom_line() + geom_point() +
facet_grid(ano ~ .) +
labs(title="Gastos", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5)))
geomas <- paste((geom_line() + geom_point() +
facet_grid(ano ~ .) +
labs(title="Gastos", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))))
geomas <- paste("(geom_line() + geom_point() +
facet_grid(ano ~ .) +
labs(title="Gastos", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5)))")
geomas <- paste("(geom_line() + geom_point() +
facet_grid(ano ~ .) +
labs(title="Gastos", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))")
(plt.alim +  geom_line() + geom_point() +
facet_grid(ano ~ .) +
labs(title="Gastos", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
)
plt.alim <- ggplot(totais["tipo"=="alimentação",], aes(x=mes, y=total))
(plt.alim +  geom_line() + geom_point() +
facet_grid(ano ~ .) +
labs(title="Gastos", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
)
totais["tipo"=="alimentação",]
totais[totais$tipo=="alimentação",]
plt.alim <- ggplot(totais[totais$tipo=="alimentação",], aes(x=mes, y=total))
(plt.alim +  geom_line() + geom_point() +
facet_grid(ano ~ .) +
labs(title="Gastos", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
)
plt.alim <- ggplot(totais[totais$tipo=="alimentação",],
aes(x=mes, y=total, colour=ano))
(plt.alim +  geom_line() + geom_point() +
labs(title="Gastos", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
)
plt <- ggplot(totais, aes(x=mes, y=total, group=tipo, colour=tipo))
(plt +  geom_line() + geom_point() +
scale_colour_manual(values = getPalette(colourCount))+
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
# guides(fill=FALSE)
)
(plt.alim +  geom_line() + geom_point() +
# facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
)
(plt.alim +  geom_line() + geom_point() +
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
)
plt.alim <- ggplot(totais[totais$tipo=="alimentação",],
aes(x=mes, y=total, colour=ano, group=ano))
(plt.alim +  geom_line() + geom_point() +
facet_grid(ano ~.) +
labs(title="Gastos por categoria", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
)
(plt.alim +  geom_line() + geom_point() +
facet_grid(ano ~.) +
labs(title="Gastos - alimentação", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
)
dev.copy(png, file="plot-alim.png")
dev.off()
write.csv(dadosFil, "dados-filtrados.csv")
dados.alim <- dadosFil[dadosFil$mes %in% c("May","Jul"), ]
View(dados.alim)
dados.alim <- dadosFil[dadosFil$mes %in% c("May","Jul") & dadosFil$tipo=="alimentação" , ]
dados.alim <- dadosFil %>% filter(mes %in% c("May","Jul") & tipo=="alimentação") %>%
arrange(ano, mes, desc(valor))
View(dados.alim)
plt.pag <- ggplot(totais[totais$tipo=="pagamentos",],
aes(x=mes, y=total, colour=ano, group=ano))
(plt.alim +  geom_line() + geom_point() +
facet_grid(ano ~.) +
labs(title="Gastos - pagamentos", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
)
(plt.pag +  geom_line() + geom_point() +
facet_grid(ano ~.) +
labs(title="Gastos - pagamentos", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
)
dev.copy(png, file="plot-pag.png")
dev.off()
dados.pag <- dadosFil %>% filter(ano %in% c(2015) & tipo=="pagamentos") %>%
arrange(ano, mes, desc(valor))
View(dados.pag)
plt.cor <- ggplot(totais[totais$tipo=="corolla",],
aes(x=mes, y=total, colour=ano, group=ano))
(plt.cor +  geom_line() + geom_point() +
facet_grid(ano ~.) +
labs(title="Gastos - Corolla", y="Total (R$)") +
theme(plot.title = element_text(hjust = 0.5))
)
dev.copy(png, file="plot-cor.png")
dev.off()
dados.cor <- dadosFil %>% filter(ano %in% c(2015) & tipo=="corolla") %>%
arrange(ano, mes, desc(valor))
View(dados.pag)
View(dados.cor)
